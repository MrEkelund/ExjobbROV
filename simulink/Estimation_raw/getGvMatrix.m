function Gv=getGvMatrix(Ts,state)
%extractstates
n=state(1);e1=state(2);e2=state(3);e3=state(4);
%Returnnoisepropagationmatrix

%oldnotbasedonfossenEulerforward.
%Gv=...
%[-(Ts^3*e1)/4,-(Ts^3*e2)/4,-(Ts^3*e3)/4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
%(Ts^3*n)/4,-(Ts^3*e3)/4,(Ts^3*e2)/4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
%(Ts^3*e3)/4,(Ts^3*n)/4,-(Ts^3*e1)/4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
%-(Ts^3*e2)/4,(Ts^3*e1)/4,(Ts^3*n)/4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
%Ts,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
%0,Ts,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
%0,0,Ts,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
%0,0,0,Ts,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
%0,0,0,0,Ts,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
%0,0,0,0,0,Ts,0,0,0,0,0,0,0,0,0,0,0,0,0;
%0,0,0,0,0,0,Ts,0,0,0,0,0,0,0,0,0,0,0,0;
%0,0,0,0,0,0,0,Ts,0,0,0,0,0,0,0,0,0,0,0;
%0,0,0,0,0,0,0,0,Ts,0,0,0,0,0,0,0,0,0,0;
%0,0,0,0,0,0,0,0,0,Ts,0,0,0,0,0,0,0,0,0;
%0,0,0,0,0,0,0,0,0,0,Ts,0,0,0,0,0,0,0,0;
%0,0,0,0,0,0,0,0,0,0,0,Ts,0,0,0,0,0,0,0;
%0,0,0,0,0,0,0,0,0,0,0,0,Ts,0,0,0,0,0,0;
%0,0,0,0,0,0,0,0,0,0,0,0,0,Ts,0,0,0,0,0;
%0,0,0,0,0,0,0,0,0,0,0,0,0,0,Ts,0,0,0,0;
%0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,Ts,0,0,0;
%0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,Ts,0,0;
%0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,Ts,0;
%0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,Ts];

%See page 298 for derivitoin of Gv discrete

Gv=[...
-(Ts^2*e1)/4,-(Ts^2*e2)/4,-(Ts^2*e3)/4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
(Ts^2*n)/4,-(Ts^2*e3)/4,(Ts^2*e2)/4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
(Ts^2*e3)/4,(Ts^2*n)/4,-(Ts^2*e1)/4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
-(Ts^2*e2)/4,(Ts^2*e1)/4,(Ts^2*n)/4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
Ts,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,Ts,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,Ts,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,Ts,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,Ts,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,Ts,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,Ts,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,Ts,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,Ts,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,Ts,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,Ts,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,Ts,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,Ts,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,Ts,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,Ts,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,Ts,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,Ts,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,Ts,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,Ts];




end