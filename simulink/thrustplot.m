%
%Thrust (kgf)	Pulse Width (us)
%X Y
map = [
-1.768181818	1100
-1.640909091	1110
-1.577272727	1120
-1.527272727	1130
-1.440909091	1140
-1.4	1150
-1.322727273	1160
-1.259090909	1170
-1.209090909	1180
-1.163636364	1190
-1.104545455	1200
-1.040909091	1210
-0.990909091	1220
-0.927272727	1230
-0.854545455	1240
-0.790909091	1250
-0.754545455	1260
-0.704545455	1270
-0.668181818	1280
-0.622727273	1290
-0.581818182	1300
-0.531818182	1310
-0.472727273	1320
-0.427272727	1330
-0.4	1340
-0.368181818	1350
-0.327272727	1360
-0.272727273	1370
-0.231818182	1380
-0.2	1390
-0.168181818	1400
-0.140909091	1410
-0.104545455	1420
-0.072727273	1430
-0.05	1440
-0.031818182	1450
-0.013636364	1460
-0.009090909	1470
0	1480
0	1500
0	1510
0	1520
0.009090909	1530
0.036363636	1540
0.063636364	1550
0.104545455	1560
0.145454545	1570
0.195454545	1580
0.254545455	1590
0.309090909	1600
0.368181818	1610
0.431818182	1620
0.481818182	1630
0.545454545	1640
0.613636364	1650
0.686363636	1660
0.736363636	1670
0.804545455	1680
0.881818182	1690
0.963636364	1700
1.059090909	1710
1.131818182	1720
1.186363636	1730
1.254545455	1740
1.304545455	1750
1.386363636	1760
1.490909091	1770
1.577272727	1780
1.654545455	1790
1.727272727	1800
1.822727273	1810
1.959090909	1820
2.045454545	1830
2.1	1840
2.181818182	1850
2.263636364	1860
2.322727273	1870
2.418181818	1880
2.486363636	1890
2.518181818	1900];
%P = [56.6703763943 298.3976377754 1453.7943326152];
P = [-1.3536   -0.4257    2.5444    0.8196    0.9102    0.0111];
thrust = polyval(P,(map(:,2) - 1500)/400);

figure(1)
plot((map(:,2)-1500)/400, map(:,1),'b', (map(:,2)-1500)/400,thrust,'--r')
ylabel('Thrust [kgf]')
xlabel('Input [%]')

polystring = 'f(u)=';
for i = 1:size(P,2)
    exponent = size(P,2)-i;

    if ((exponent == (size(P,2)-1)) && (exponent > 0))
        new_string = strcat(num2str(P(i)),'*u^',int2str(exponent));
    elseif exponent <= 0
        if P(i) > 0
         tecken = strcat('+',num2str(P(i)));
        else
            tecken = num2str(P(i));
        end
        new_string = tecken;
    elseif exponent ==1
        if P(i) > 0
         tecken = strcat('+',num2str(P(i)));
        else
            tecken = num2str(P(i));
        end
        new_string = strcat(tecken,'*u');
    else
        if P(i) >= 0
            tecken = strcat('+',num2str(P(i)));
        else
            tecken = num2str(P(i));
        end
        new_string = strcat(tecken, '*u^',int2str(exponent));
    end
    polystring = strcat(polystring,new_string);
end
legend('Measured',polystring ,'location','NorthWest')
%print -f1 -depsc2 thrusterplot.eps
%print -f1 -dpdf thrusterplot.pdf


% latex_map = [];
% for i = 1:size(map,1)
%     temp = strcat(num2str(map(i,1)), ' & ', num2str(map(i,2)), ' \\');
%     disp(temp)
%     latex_map{i} = temp;  
% end
